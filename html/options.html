<!-- html/options.html -->
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>FastProxy è®¾ç½®ä¸­å¿ƒ</title>
  <style>
    :root {
      --primary: #6366f1; --primary-light: #e0e7ff; --primary-hover: #4f46e5;
      --bg-body: #f3f4f6; --bg-card: #ffffff;
      --text-main: #111827; --text-sub: #6b7280; --border: #e5e7eb;
      --danger: #ef4444; --success: #10b981; --warning: #f59e0b;
      --radius: 16px; --radius-sm: 8px;
    }
    html[data-theme="dark"] {
      --primary: #818cf8; --primary-light: rgba(99, 102, 241, 0.15); --primary-hover: #a5b4fc;
      --bg-body: #0f172a; --bg-card: #1e293b; --text-main: #f1f5f9; --text-sub: #94a3b8; --border: #334155;
      --danger: #f87171; --success: #34d399; --warning: #fbbf24;
    }
    body { margin: 0; padding: 0; font-family: 'Inter', system-ui, sans-serif; background: var(--bg-body); color: var(--text-main); display: flex; height: 100vh; overflow: hidden; }
    .app-sidebar { width: 260px; background: var(--bg-card); border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 20px; gap: 10px; }
    .brand { padding: 10px 15px 30px; font-size: 20px; font-weight: 800; color: var(--primary); display: flex; align-items: center; gap: 12px; }
    .menu { list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 4px; }
    .menu-item { padding: 12px 16px; border-radius: var(--radius-sm); cursor: pointer; display: flex; align-items: center; gap: 12px; font-size: 14px; font-weight: 500; color: var(--text-sub); transition: 0.2s; }
    .menu-item:hover { background: var(--bg-body); color: var(--text-main); }
    .menu-item.active { background: var(--primary-light); color: var(--primary); font-weight: 600; }
    .menu-footer { margin-top: auto; padding: 20px 0; font-size: 12px; color: var(--text-sub); text-align: center; opacity: 0.6; }
    .app-main { flex: 1; overflow-y: auto; padding: 40px; }
    .container { max-width: 900px; margin: 0 auto; }
    .section { display: none; animation: fadeIn 0.3s ease; }
    .section.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: 0; } }
    h2 { margin: 0 0 24px 0; font-size: 24px; font-weight: 700; display: flex; align-items: center; justify-content: space-between; }
    .card { background: var(--bg-card); border-radius: var(--radius); box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06); border: 1px solid var(--border); padding: 24px; margin-bottom: 24px; }
    .form-group { margin-bottom: 20px; }
    label { display: block; margin-bottom: 8px; font-size: 13px; font-weight: 600; color: var(--text-sub); text-transform: uppercase; letter-spacing: 0.5px; }
    input[type="text"], input[type="password"], input[type="number"], select { width: 100%; padding: 10px 14px; border-radius: var(--radius-sm); border: 1px solid var(--border); background: var(--bg-body); color: var(--text-main); font-size: 14px; box-sizing: border-box; transition: 0.2s; }
    input:focus, select:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px var(--primary-light); }
    .btn { padding: 10px 20px; border-radius: var(--radius-sm); border: none; cursor: pointer; font-size: 13px; font-weight: 600; transition: 0.2s; display: inline-flex; align-items: center; gap: 8px; }
    .btn-sm { padding: 6px 12px; font-size: 12px; }
    .btn-primary { background: var(--primary); color: #fff; }
    .btn-primary:hover { background: var(--primary-hover); box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3); }
    .btn-danger { background: rgba(239, 68, 68, 0.1); color: var(--danger); }
    .btn-danger:hover { background: var(--danger); color: #fff; }
    .btn-ghost { background: transparent; border: 1px solid var(--border); color: var(--text-main); }
    .btn-ghost:hover { border-color: var(--text-sub); }
    .btn-success { background: var(--success); color: #fff; }
    #serverListContainer { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 16px; }
    .server-item { background: var(--bg-body); border: 2px solid transparent; border-radius: var(--radius-sm); padding: 16px; cursor: pointer; transition: 0.2s; position: relative; }
    .server-item:hover { transform: translateY(-2px); border-color: var(--primary-light); }
    .server-item.active { border-color: var(--primary); background: var(--primary-light); }
    .server-item.active .server-name { color: var(--primary); }
    .server-tag { font-size: 10px; font-weight: 700; background: rgba(0,0,0,0.1); padding: 2px 6px; border-radius: 4px; }
    .server-actions { margin-top: 12px; display: flex; justify-content: flex-end; gap: 8px; opacity: 0; transition: 0.2s; }
    .server-item:hover .server-actions { opacity: 1; }
    .rule-toolbar { display: flex; gap: 10px; margin-bottom: 15px; background: var(--bg-body); padding: 10px; border-radius: var(--radius-sm); }
    .rule-list { height: 400px; overflow-y: auto; border: 1px solid var(--border); border-radius: var(--radius-sm); }
    .rule-item { padding: 10px 16px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; font-family: monospace; font-size: 13px; }
    .rule-item:hover { background: var(--bg-body); }
    .info-tip { background: var(--primary-light); color: var(--primary); border-radius: var(--radius-sm); padding: 12px 16px; font-size: 13px; line-height: 1.5; margin-bottom: 20px; }
    .help-text { font-size: 12px; color: var(--text-sub); margin-top: 6px; }
    #toast { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(50px); background: #111827; color: #fff; padding: 10px 24px; border-radius: 50px; font-size: 14px; font-weight: 500; opacity: 0; transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); box-shadow: 0 10px 25px rgba(0,0,0,0.2); z-index: 100; }
    #toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }
  </style>
</head>
<body>

  <aside class="app-sidebar">
    <div class="brand"><span>âš¡</span> FastProxy</div>
    <ul class="menu">
      <li class="menu-item active" data-target="server"><span>ğŸ“¡</span> æœåŠ¡å™¨é…ç½®</li>
      <li class="menu-item" data-target="rules"><span>ğŸ“</span> è§„åˆ™ç®¡ç†</li>
      <li class="menu-item" data-target="gfw"><span>ğŸŒ</span> GFWList</li>
      <li class="menu-item" data-target="sync"><span>â˜ï¸</span> äº‘ç«¯åŒæ­¥</li>
      <li class="menu-item" data-target="about"><span>âš™ï¸</span> é€šç”¨è®¾ç½®</li>
    </ul>
    <div class="menu-footer">Version 7.3.11 Pro</div>
  </aside>

  <main class="app-main">
    <div class="container">
      
      <!-- æœåŠ¡å™¨é…ç½® -->
      <div id="section-server" class="section active">
        <h2>
          ä»£ç†æœåŠ¡å™¨
          <div style="display:flex; gap:10px;">
            <button id="testLatencyBtn" class="btn btn-ghost btn-sm">ğŸ“¶ æµ‹è¯•å»¶è¿Ÿ</button>
            <button id="addServerBtn" class="btn btn-primary btn-sm">â• æ–°å»ºæœåŠ¡å™¨</button>
          </div>
        </h2>
        <div id="latencyResult" style="margin-bottom:15px; padding:10px; border-radius:8px; background:var(--bg-body); display:none; text-align:center;"></div>
        
        <div id="serverListContainer"></div>

        <div id="serverForm" class="card" style="display:none; margin-top:20px; border:2px dashed var(--primary);">
          <h3 style="margin-top:0;">ç¼–è¾‘æœåŠ¡å™¨</h3>
          <div style="display:grid; grid-template-columns: 2fr 1fr; gap:15px; margin-bottom:15px;">
            <div><label>å¤‡æ³¨åç§°</label><input type="text" id="editName" placeholder="ä¾‹å¦‚: é¦™æ¸¯èŠ‚ç‚¹ 01"></div>
            <div><label>åè®®ç±»å‹</label><select id="editScheme"><option value="SOCKS5">SOCKS5</option><option value="HTTP">HTTP</option></select></div>
          </div>
          <div style="display:grid; grid-template-columns: 3fr 1fr; gap:15px; margin-bottom:20px;">
            <div><label>æœåŠ¡å™¨åœ°å€ (IP/åŸŸå)</label><input type="text" id="editHost" placeholder="127.0.0.1"></div>
            <div><label>ç«¯å£</label><input type="number" id="editPort" placeholder="1080"></div>
          </div>
          <div style="text-align:right;">
            <button id="cancelServerItemBtn" class="btn btn-ghost">å–æ¶ˆ</button>
            <button id="saveServerItemBtn" class="btn btn-primary">ä¿å­˜é…ç½®</button>
          </div>
        </div>
      </div>

      <!-- è§„åˆ™ç®¡ç† -->
      <div id="section-rules" class="section">
        <h2>è§„åˆ™ç®¡ç†</h2>
        <div class="card">
          <div style="display:flex; margin-bottom:15px;">
             <select id="ruleTypeSelect" style="flex:1; padding:12px; font-weight:bold; border-radius:var(--radius-sm); border-color:var(--border);">
              <option value="userRules">ğŸš€ é»‘åå• (å¼ºåˆ¶ä»£ç†åŸŸå)</option>
              <option value="userWhitelist">ğŸ›¡ï¸ ç™½åå• (å¼ºåˆ¶ç›´è¿åŸŸå)</option>
            </select>
          </div>
          
          <div class="rule-toolbar">
            <input type="text" id="ruleSearch" placeholder="ğŸ” æœç´¢åŸŸå..." style="flex:1; background:var(--bg-card);">
            <input type="text" id="ruleAddInput" placeholder="è¾“å…¥åŸŸåå›è½¦æ·»åŠ " style="flex:1; background:var(--bg-card);">
            <button id="ruleAddBtn" class="btn btn-primary btn-sm">æ·»åŠ </button>
          </div>
          
          <div style="display:flex; justify-content:space-between; margin-bottom:10px; font-size:12px; color:var(--text-sub);">
            <span>å…± <b id="currentRuleCount">0</b> æ¡è§„åˆ™</span>
            <span>æ“ä½œ: åŒå‡»ä¿®æ”¹ | å³ä¾§åˆ é™¤</span>
          </div>

          <div class="rule-list" id="ruleListContainer"></div>

          <div style="display:flex; justify-content:space-between; margin-top:15px;">
            <div style="display:flex; gap:10px;">
              <button id="ruleExportBtn" class="btn btn-ghost btn-sm">ğŸ“¤ å¯¼å‡º</button>
              <button id="ruleImportBtn" class="btn btn-ghost btn-sm">ğŸ“¥ å¯¼å…¥</button>
              <input type="file" id="ruleFile" style="display:none" accept=".json">
            </div>
            <button id="ruleClearBtn" class="btn btn-ghost btn-sm" style="color:var(--danger)">ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨</button>
          </div>
        </div>
      </div>

      <!-- GFWList -->
      <div id="section-gfw" class="section">
        <h2>GFWList æ™ºèƒ½è§„åˆ™åº“</h2>
        <div class="card">
          <div class="info-tip">
             ğŸ’¡ GFWList æ˜¯ä¸€ä¸ªç»´æŠ¤åœ¨ GitHub ä¸Šçš„è¢«å¢™ç½‘ç«™åˆ—è¡¨ã€‚å¯ç”¨åï¼Œæ’ä»¶ä¼šè‡ªåŠ¨åˆ¤æ–­è®¿é—®çš„åŸŸåæ˜¯å¦åœ¨åˆ—è¡¨ä¸­ï¼Œåœ¨åˆ™ä»£ç†ï¼Œä¸åœ¨åˆ™ç›´è¿ã€‚
          </div>
          <div class="form-group">
            <label>è§„åˆ™æºåœ°å€</label>
            <select id="gfwSourceSelect">
              <option value="https://raw.githubusercontent.com/gfwlist/gfwlist/master/gfwlist.txt">GitHub Official (éœ€è¦ä»£ç†)</option>
              <option value="https://cdn.jsdelivr.net/gh/gfwlist/gfwlist/gfwlist.txt">jsDelivr CDN (æ¨èï¼Œé€Ÿåº¦å¿«)</option>
              <option value="custom">è‡ªå®šä¹‰ URL...</option>
            </select>
            <input type="text" id="gfwUrlInput" placeholder="è¾“å…¥ URL" style="display:none; margin-top:10px;">
          </div>
          <div style="display:flex; justify-content:space-between; align-items:center; background:var(--bg-body); padding:15px; border-radius:var(--radius-sm);">
            <div>
              <div style="font-weight:600; font-size:14px;">å½“å‰çŠ¶æ€</div>
              <div id="gfwStatus" style="font-size:13px; color:var(--text-sub); margin-top:4px;">æœªåŠ è½½</div>
            </div>
            <button id="updateGfwBtn" class="btn btn-success">ğŸ”„ ç«‹å³æ›´æ–°è§„åˆ™åº“</button>
          </div>
        </div>
      </div>

      <!-- äº‘åŒæ­¥ -->
      <div id="section-sync" class="section">
        <h2>äº‘ç«¯åŒæ­¥ <span id="syncStatusBadge" class="server-tag" style="background:#ccc; color:#fff; margin-left:10px;">æœªåŒæ­¥</span></h2>
        <div class="card">
          <div class="form-group">
            <label>åŒæ­¥æœåŠ¡æä¾›å•†</label>
            <div style="display:flex; gap:15px;">
              <select id="syncProvider" style="flex:1">
                <option value="github">GitHub Gist (æ¨èï¼Œç¨³å®šå…è´¹)</option>
                <option value="webdav">WebDAV (åšæœäº‘/Nextcloud)</option>
              </select>
              <div style="display:flex; align-items:center;">
                <input type="checkbox" id="autoSync" style="width:auto; margin-right:8px;">
                <span style="font-size:13px;">è‡ªåŠ¨åŒæ­¥ (æ¯24h)</span>
              </div>
            </div>
          </div>
          
          <div class="info-tip" style="background:var(--bg-body); color:var(--text-sub); border:1px solid var(--border);">
            ğŸ”’ å®‰å…¨æç¤ºï¼šä¸Šä¼ çš„æ•°æ®å°†ç»è¿‡ <b>Base64 ç¼–ç </b> æ··æ·†å¤„ç†ï¼Œé˜²æ­¢åœ¨äº‘ç«¯ä»¥æ˜æ–‡å½¢å¼ç›´æ¥è¯»å–ã€‚æ­¤æ–¹å¼æ— éœ€å¯†ç ï¼Œå³ä½¿æ›´æ¢è´¦å·æˆ–è®¾å¤‡ä¹Ÿèƒ½è½»æ¾æ¢å¤æ•°æ®ã€‚
          </div>

          <div id="panelGithub" style="background:var(--bg-body); padding:20px; border-radius:var(--radius-sm); margin-bottom:20px;">
            <div class="form-group">
              <label>GitHub Token (Personal Access Token)</label>
              <input type="password" id="gitToken" placeholder="ghp_xxxxxxxxxxxx...">
              <p class="help-text">è¯·åœ¨ GitHub Settings -> Developer Settings ç”Ÿæˆ Tokenï¼Œå‹¾é€‰ 'gist' æƒé™ã€‚</p>
            </div>
          </div>

          <div id="panelWebdav" style="display:none; background:var(--bg-body); padding:20px; border-radius:var(--radius-sm); margin-bottom:20px;">
            <div class="form-group"><label>æœåŠ¡å™¨åœ°å€</label><input type="text" id="davUrl" placeholder="https://dav.jianguoyun.com/dav/"></div>
            <div style="display:flex; gap:10px;">
              <div style="flex:1"><label>è´¦å·</label><input type="text" id="davUser"></div>
              <div style="flex:1"><label>å¯†ç </label><input type="password" id="davPass"></div>
            </div>
          </div>

          <div style="display:flex; justify-content:center; gap:20px;">
             <button id="cloudUploadBtn" class="btn btn-primary" style="width:160px; justify-content:center;">â¬†ï¸ ä¸Šä¼ é…ç½®</button>
             <button id="cloudDownloadBtn" class="btn btn-ghost" style="width:160px; justify-content:center;">â¬‡ï¸ ä¸‹è½½è¦†ç›–</button>
          </div>
        </div>
      </div>

      <!-- é€šç”¨è®¾ç½® -->
      <div id="section-about" class="section">
        <h2>é€šç”¨è®¾ç½®</h2>
        <div class="card">
          <div class="form-group">
            <label>ç•Œé¢ä¸»é¢˜</label>
            <select id="themeSelect">
              <option value="system">ğŸ–¥ï¸ è·Ÿéšç³»ç»Ÿè®¾ç½®</option>
              <option value="light">ğŸŒ æµ…è‰²æ¨¡å¼</option>
              <option value="dark">ğŸŒ™ æ·±è‰²æ¨¡å¼</option>
            </select>
          </div>
        </div>
        <div class="card" style="border-color:rgba(239, 68, 68, 0.3);">
          <h3 style="color:var(--danger); margin-top:0;">å±é™©åŒºåŸŸ</h3>
          <p class="help-text" style="margin-bottom:15px;">å¦‚æœæ‚¨é‡åˆ°ä¸¥é‡é”™è¯¯ï¼Œå¯ä»¥å°è¯•é‡ç½®æ‰©å±•ã€‚è¿™å°†æ¸…é™¤æ‰€æœ‰æœ¬åœ°è§„åˆ™å’ŒæœåŠ¡å™¨é…ç½®ã€‚</p>
          <button id="resetAppBtn" class="btn btn-danger">ğŸ”¥ é‡ç½®æ‰€æœ‰æ•°æ®</button>
        </div>
      </div>

    </div>
  </main>

  <div id="toast">æ“ä½œæˆåŠŸ</div>
  <script src="../js/options.js"></script>
</body>
</html>